{% extends "layout/layout.html" %}
{% block title %}Usuarios{% endblock %}
{% block head %}
{{ super() }}
{% endblock %}
{% block content %}
<div class="row">
  <h1 class="col-10">Usuarios</h1>
  <a class="col" href="{{ url_for('user_new') }}"><button class="btn btn-success">Nuevo usuario</button></a>
</div>
<table class="table">
  <thead>
    <tr>
      <th class="table-dark">Email</th>
      <th class="table-dark">Nombre</th>
      <th class="table-dark">Apellido</th>
      <th class="table-dark">Contrase√±a</th>
      <th class="table-dark">Roles</th>
      <th class="table-dark">Activo/Inactivo</th>
      <th class="table-dark">Acciones</th>
      <th class="table-dark"></th>
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
    <tr>
      <td class="table-light">{{user.email}}</td>
      <td class="table-light">{{user.first_name}}</td>
      <td class="table-light">{{user.last_name}}</td>
      <td class="table-light">{{user.password}}</td>
      <td class="table-light">
        {% for rol in user.roles %}
        {{ rol.name }}
        {% endfor %}
      </td>

      <td class="table-light">
        {% if user.active %}
        Activo
        {% else %}
        Inactivo
        {% endif %}
        <a href="{{url_for('user_toggle',user_email=user.email)}}">
          (cambiar)
        </a>
      </td>

      <td class="table-light">
        {% if check_permission(current_user, "usuario_destroy") %}
        <form action="" method="POST">
          <button name="destroy_id" value="{{ user.id }}" formaction="{{ url_for('user_destroy') }}" type="submit"
            class="btn btn-danger">Eliminar</a>
        </form>
        {% endif %}
      </td>
      <td class="table-light">
        {% if check_permission(current_user, "usuario_update") %}
        <form action="" method="POST">
          <button name="edit_id" value="{{ user.id }}" formaction="{{ url_for('user_edit',id=user.id) }}" type="submit"
            class="btn btn-secondary">Editar</a>
        </form>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}